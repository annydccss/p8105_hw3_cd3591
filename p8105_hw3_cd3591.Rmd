---
title: "p8105_hw3_cd3591"
author: "Anny"
date: "2025-10-10"
output: github_document
---

```{r}
# set up libraries and the dataset
library(tidyverse)
library(p8105.datasets)
data("instacart")
```

# Problem 1
```{r}
# basic structure of the dataset
str(instacart)
head(instacart) # illustrative examples of observations
```
*Short Description*: The instacart dataset contains `r nrow(instacart)` observations of `r ncol(instacart)` variables, representing individual grocery orders placed through the Instacart platform. Each observation corresponds to a single product ordered by a user. Key variables include: order_id, indicating unique identifier for each order;  product_id & product_name, identifying the product ordered; aisle_id / department_id, describing where the product is found; order_hour_of_day, showing the time of order placement; order_dow, indicating the day of week (0 = Sunday).

1)
```{r}
# How many aisles are there, and which aisles are the most items ordered from?
aisle = instacart %>% count(aisle, sort = TRUE)
n_aisle = nrow(aisle)
head(aisle, 3)
```
There are `n_aisle` aisles in total. The most frequently ordered aisles are fresh vegetables, fresh fruits, and packaged vegetables fruits.

2)
```{r}
aisle %>%
  filter(n > 10000) %>%  # limiting this to aisles with more than 10000 items ordered
  mutate(aisle = fct_reorder(aisle, n)) %>%
  ggplot(aes(x = n, y = aisle)) +  # Make a plot that shows the number of items ordered in each aisle
  geom_col() +
  labs(title = "Number of Items Ordered per Aisle (>10,000 orders)",
       x = "Number of Items Ordered", y = "Aisle Name")   
       # since there are long labels like “packaged vegetables fruits”, fit much better along the y-axis than rotated on the x-axis.
```

3)
```{r}
popular_items = instacart %>%  # Make a table
  filter(aisle == "baking ingredients" |
    aisle == "dog food care" |
    aisle == "packaged vegetables fruits") %>%  
  # in each of the aisles “baking ingredients”, “dog food care”, and “packaged vegetables fruits”
  group_by(aisle, product_name) %>%
  summarise(times_ordered = n()) %>%  # Include the number of times each item is ordered in your table
  slice_max(times_ordered, n = 3)  # showing the three most popular items

popular_items
```

4)
```{r}
mean_hour = instacart %>%  # Make a table
  filter(product_name == "Pink Lady Apples" | 
           product_name == "Coffee Ice Cream") %>%  # at which Pink Lady Apples and Coffee Ice Cream
  group_by(product_name, order_dow) %>%  # ordered on each day of the week
  summarise(mean_hour = mean(order_hour_of_day)) %>%  # showing the mean hour of the day
  pivot_wider(names_from = order_dow, values_from = mean_hour) %>%  # produce a 2 x 8 table
  rename(Sun = "0", Mon = "1", Tue = "2", Wed = "3", Thu = "4", Fri = "5", Sat = "6")

mean_hour
```

